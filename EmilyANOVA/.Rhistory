knitr::opts_chunk$set(echo = TRUE)
library(readxl)
library(tidyverse)
library(dplyr)
library(rstatix)
library(afex)
library(lme4)
library(emmeans)
library(ggpubr)
#Bring in Data file
femaleData <-  read.csv("C:/Users/thoma/Documents/fem_anova_df.csv")
#Rename DUration column
colnames(femaleData)[colnames(femaleData) == 'Duration_.ms.'] <- 'Duration'
#Remove long strings from ID (Still retains all 144 ppts)
femaleData$ID <- substr(femaleData$ID, 1, 6)
#Convert relevent columns to factors for ANOVA
femaleData$Duration <- as.factor(femaleData$Duration)
femaleData$Type <- as.factor(femaleData$Type)
femaleData$ID <- as.factor(femaleData$ID)
#femaleData$File <- as.factor(femaleData$File)
femaleData$X <- as.factor(femaleData$X)
#show the levels in the ID factor (Used for debugging)
#levels(femaleData$ID)
#Plot a very basic histogram of all the data
ggplot(femaleData, aes(x = Rating ))+
geom_histogram(binwidth = 1)
#Boxplot of the data for both within and between conditions
ggplot(femaleData, aes(x=Duration, y=Rating, fill=Type)) +
geom_boxplot(outlier.shape = NA)
#Split the data set into 3 based on each Dimensions
AttrData <- femaleData[femaleData$Dimension == 'Attractiveness',]
DomData <- femaleData[femaleData$Dimension == 'Dominance',]
TrustData <- femaleData[femaleData$Dimension == 'Trustworthiness',]
#Summarise the means and SD ratings for each of the 3 dimensions
AttrSum <- AttrData %>%
group_by(Duration, Type) %>%
summarise(n = n(),
mean = mean(Rating),
sd = sd(Rating))
DomSum <- DomData %>%
group_by(Duration, Type) %>%
summarise(n = n(),
mean = mean(Rating),
sd = sd(Rating))
TrustSum <- TrustData %>%
group_by(Duration, Type) %>%
summarise(n = n(),
mean = mean(Rating),
sd = sd(Rating))
#plot the spread of the data for each fo the dimensions
ggplot(AttrData, aes(x = Duration, y = Rating, fill = Type ))+
geom_violin()+
geom_boxplot()+
labs(title = "Attractiveness")
ggplot(DomData, aes(x = Duration, y = Rating, fill = Type ))+
geom_violin()+
geom_boxplot()+
labs(title = "Dominance")
ggplot(TrustData, aes(x = Duration, y = Rating, fill = Type ))+
geom_violin()+
geom_boxplot()+
labs(title = "Trustworthiness")
#check for outliers in the main dataset
outlier<-femaleData %>%
group_by(Duration,Type) %>%
identify_outliers(Rating)
data.frame(outlier)
#plot a quantile-quantile plot to compare distributions
#sigmoidal shape because ratings are between 0 and 100
ggqqplot(femaleData, "Rating", ggtheme = theme_bw()) +
facet_grid(Type ~ Duration)
#qqplot(femaleData$Type, femaleData$Rating, xlab = "test x", ylab = "test y", main = "Q-Q Plot")
#Test assumptions of big data set - not sure if they meet them
femaleData %>%
group_by(Duration) %>%
levene_test(Rating ~ Type)
box_m(femaleData[, "Rating", drop = FALSE], femaleData$Duration)
#FIrst attempt at mixed ANOVA but produces an error due to number of factors
#resATTR <- anova_test(data = AttrData, dv = Rating, between = Duration, within = Type, wid = X)
#get_anova_table(res)
#Conduct mixed ANOVA for each of the dimensions(next 3 chunks) from the afex package
mixed_anova_Attr <- aov_ez(
id = "ID",
dv = "Rating",
data = AttrData,
between = "Duration",
within = "Type"
)
summary(mixed_anova_Attr)
knitr::kable(nice(mixed_anova_Attr))
mixed_anova_Dom <- aov_ez(
id = "ID",
dv = "Rating",
data = DomData,
between = "Duration",
within = "Type",
anova_table = list(p_adjust_method = "holm")
)
summary(mixed_anova_Dom)
knitr::kable(nice(mixed_anova_Dom))
mixed_anova_Trust<- aov_ez(
id = "ID",
dv = "Rating",
data = TrustData,
between = "Duration",
within = "Type",
anova_table = list(p_adjust_method = "holm")
)
summary(mixed_anova_Trust)
pairwise.t.test(TrustData$Rating, TrustData$Type, p.adjust.method="bonferroni")
knitr::kable(nice(mixed_anova_Trust))
#Test sphericity for each of the dimensions
test_sphericity(mixed_anova_Attr)
test_sphericity(mixed_anova_Dom)
test_sphericity(mixed_anova_Trust)
#Produce horrific plots for each of the dimensions
afex_plot(mixed_anova_Attr, x = "Type", trace = "Duration")
afex_plot(mixed_anova_Dom, x = "Type", trace = "Duration")
afex_plot(mixed_anova_Trust, x = "Type", trace = "Duration")
#Different method for Mixed ANOVA
Mixed.aov.Attr<-aov_car(Rating ~ Duration*Type + Error(ID/Type), data=AttrData)
summary(Mixed.aov.Attr)
Mixed_Fitted_Type_Attr<-emmeans(Mixed.aov.Attr, ~Type)
Mixed_Fitted_Type_Attr
Mixed_Fitted_Duration_Attr<-emmeans(Mixed.aov.Attr, ~Duration)
Mixed_Fitted_Duration_Attr
Mixed_Fitted_Interaction_Attr<-emmeans(Mixed.aov.Attr, specs = pairwise ~Type*Duration, type = "response", adjust = "holm")
Mixed_Fitted_Interaction_Attr
knitr::kable((Mixed_Fitted_Interaction_Attr$emmeans))
knitr::kable((Mixed_Fitted_Interaction_Attr$contrast))
pairs(Mixed_Fitted_Interaction_Attr)
knitr::kable((pairs(Mixed_Fitted_Interaction_Attr)))
ggplot(AttrData, aes(x = Duration, y = Rating, fill = Type ))+
geom_boxplot()+
labs(title = "Attractiveness")
#Different method for Mixed ANOVA
Mixed.aov.Dom<-aov_car(Rating ~ Duration*Type + Error(ID/Type), data=DomData)
summary(Mixed.aov.Dom)
Mixed_Fitted_Type_Dom<-emmeans(Mixed.aov.Dom,  ~Type)
Mixed_Fitted_Type_Dom
Mixed_Fitted_Duration_Dom<-emmeans(Mixed.aov.Dom, ~Duration)
Mixed_Fitted_Duration_Dom
Mixed_Fitted_Interaction_Dom<-emmeans(Mixed.aov.Dom, specs = pairwise ~Type*Duration, type = "response", adjust = "holm")
Mixed_Fitted_Interaction_Dom
knitr::kable((Mixed_Fitted_Interaction_Dom$emmeans))
knitr::kable((Mixed_Fitted_Interaction_Dom$contrast))
pairs(Mixed_Fitted_Interaction_Dom)
knitr::kable((pairs(Mixed_Fitted_Interaction_Dom)))
pairs2 <- emmeans(Mixed.aov.Dom, pairwise ~Type|Duration)
pairs2
ggplot(DomData, aes(x = Duration, y = Rating, fill = Type ))+
geom_boxplot()+
labs(title = "Dominance")
#Different method for Mixed ANOVA
Mixed.aov.Trust<-aov_car(Rating ~ Duration*Type + Error(ID/Type), data=TrustData)
summary(Mixed.aov.Trust)
Mixed_Fitted_Type_Trust<-emmeans(Mixed.aov.Trust, ~Type)
Mixed_Fitted_Type_Trust
Mixed_Fitted_Duration_Trust<-emmeans(Mixed.aov.Trust, ~Duration)
Mixed_Fitted_Duration_Trust
Mixed_Fitted_Interaction_Trust<-emmeans(Mixed.aov.Trust, specs = pairwise ~Type*Duration, type = "response", adjust = "holm")
Mixed_Fitted_Interaction_Trust
knitr::kable((Mixed_Fitted_Interaction_Trust$emmeans))
knitr::kable((Mixed_Fitted_Interaction_Trust$contrast))
pairs(Mixed_Fitted_Interaction_Trust)
knitr::kable(pairs(Mixed_Fitted_Interaction_Trust))
ggplot(TrustData, aes(x = Duration, y = Rating, fill = Type ))+
geom_boxplot()+
labs(title = "Trustworthiness")
#Code for mixed effets models
NullModelAttr <- lmer(data = AttrData, formula = Rating ~ (1|ID))
summary(NullModelAttr)
Model1Attr = lmer(data = AttrData, formula = Rating ~ Duration * Type + (1|ID))
summary(Model1Attr)
maleData <-  read.csv("C:/Users/thoma/Documents/male_anova_df.csv")
#Rename DUration column
colnames(maleData)[colnames(maleData) == 'Duration_.ms.'] <- 'Duration'
#Remove long strings from ID (Still retains all 144 ppts)
maleData$ID <- substr(maleData$ID, 1, 6)
#Convert relevent columns to factors for ANOVA
maleData$Duration <- as.factor(maleData$Duration)
maleData$Type <- as.factor(maleData$Type)
maleData$ID <- as.factor(maleData$ID)
#maleData$File <- as.factor(maleData$File)
maleData$X <- as.factor(maleData$X)
#show the levels in the ID factor (Used for debugging)
#levels(maleData$ID)
femaleData <-  read.csv("C:/Users/thoma/Documents/fem_anova_df.csv")
