---
title: "NASATLX_Qualtrics"
output: html_document
date: '2022-03-23'
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
library(tidyverse)
library(readr)
library(janitor)
library(car)
library(emmeans)
```


```{r}
#Read in the data
TLXdataRaw <- read.csv("C:/Users/thoma/OneDrive - University of Glasgow/Desktop/Study3/data/Qualtrics/TLX/Study3TLX.csv") %>% 

# Tidy the data - select scores,
  select(starts_with('Q'))
  TLXdataOrg <- TLXdataRaw[-c(1:2),]
  colnames(TLXdataOrg) <- c('Ppt_ID','Block', 'Mental Demand', 'Physical Demand', 'Temporal Demand', 'Overall Performance', 'Effort', 'Frustration')
  #Convert columns with ratings in to numeric
  TLXdataOrg[3:8] = lapply(TLXdataOrg[3:8], FUN = function(y){as.numeric(y)})
  
  TLXdataOrg$Block <- str_sub(TLXdataOrg$Block, 1,7)
  
  TLXdataOrg$Block[TLXdataOrg$Block == "Level 1"] <- "HUD - ARD"
  TLXdataOrg$Block[TLXdataOrg$Block == "Level 2"] <- "HUD - AR Cued"
  TLXdataOrg$Block[TLXdataOrg$Block == "Level 3"] <- "HDD - Tablet"
  TLXdataOrg$Block[TLXdataOrg$Block == "Level 4"] <- "HDD - AR"
  
```


```{r}
#Convert to wrangled dataset
TLXdata <- TLXdataOrg 

TLXdata$Performance <- 100 - TLXdata$`Overall Performance` 

TLXdata <- TLXdata %>%  select(-`Overall Performance`)

TLXdata$Total = rowSums(TLXdata[,c(3,8)], na.rm = T)


```


```{r}
TLXdataTotalSum <- TLXdata %>% 
  group_by(Block) %>% 
  summarise(
    n = n(),
    mean = mean(Total),
    sd = sd(Total)
  )
```


```{r}
TLXdataSumm <- TLXdata %>% 
  
  group_by(Block) %>% 
  summarise(
    n = n(),
    Mental_mean = mean(`Mental Demand`),
    Mental_sd = sd(`Mental Demand`),
    Physical_mean = mean(`Physical Demand`),
    Physical_sd = sd(`Physical Demand`),
    Temporal_mean = mean(`Temporal Demand`),
    Temporal_sd = sd(`Temporal Demand`),
    Performance_mean = mean(Performance),
    Performance_sd = sd(Performance),
    Frustration_mean = mean(Frustration),
    Frustration_sd = sd(Frustration),
    Effort_mean = mean(Effort),
    Effort_sd = sd(Effort)
    
  )


```

```{r}
ggplot(TLXdata, aes(Block, Total, fill = Block ))+
  geom_boxplot(width = 0.3, fill = 0.1)+
  geom_violin(alpha = 0.4, colour = 0)+
  labs(title = "Total")
```


```{r}
ggplot(TLXdata, aes(Block, `Mental Demand`, fill = Block ))+
  geom_boxplot(width = 0.3)+
  geom_violin(alpha = 0.5)+
  ylim(0,100)+
  labs(title = "Mental Demand")

ggplot(TLXdata, aes(Block, `Physical Demand`, fill = Block ))+
  geom_boxplot(width = 0.3)+
  geom_violin(alpha = 0.5)+
  ylim(0,100)+
    labs(title = "Physical Demand")

ggplot(TLXdata, aes(Block, `Temporal Demand`, fill = Block ))+
  geom_boxplot(width = 0.3)+
  geom_violin(alpha = 0.5)+
  ylim(0,100)+
    labs(title = "Temporal Demand")

ggplot(TLXdata, aes(Block,Performance, fill = Block ))+
  geom_boxplot(width = 0.3)+
  geom_violin(alpha = 0.5)+
  ylim (100,0)+
    labs(title = "Overall Performance (Inverted)")

ggplot(TLXdata, aes(Block, Effort, fill = Block ))+
  geom_boxplot(width = 0.3)+
  geom_violin(alpha = 0.5)+
  ylim (0,100)+
    labs(title = "Effort")
  
ggplot(TLXdata, aes(Block, Frustration, fill = Block ))+
  geom_boxplot(width = 0.3)+
  geom_violin(alpha = 0.5)+
  ylim (0,100)+
    labs(title = "Frustration")


```



```{r}
Total_Aov = lm(Total ~ Block, data = TLXdata) 
print("Total")

Anova(Total_Aov,
      type = "II")

```



```{r}

MD_Aov = lm(`Mental Demand` ~ Block , data = TLXdata) 
print("Mental Demand")

Anova(MD_Aov,
      type = "II")

print("Physical Demand")
PD_Aov = lm(`Physical Demand` ~ Block , data = TLXdata) 

Anova(PD_Aov,
      type = "II")

TD_Aov = lm(`Temporal Demand` ~ Block , data = TLXdata) 
print("Temporal Demand")

Anova(TD_Aov,
      type = "II")

OP_Aov = lm(Performance ~ Block , data = TLXdata) 
print("Overall Performance")

Anova(OP_Aov,
      type = "II")

EF_Aov = lm(Effort ~ Block , data = TLXdata) 
print("Effort")

Anova(EF_Aov,
      type = "II")

FR_Aov = lm(Frustration ~ Block , data = TLXdata)
print("Frustration")

Anova(FR_Aov,
      type = "II")
```


```{r}
MDmarginal = emmeans(MD_Aov, ~Block)
pairs(MDmarginal, adjust="tukey")
```


```{r}
PDmarginal = emmeans(PD_Aov, ~Block)
pairs(PDmarginal, adjust="tukey")

```


```{r}
TDmarginal = emmeans(TD_Aov, ~Block)
pairs(TDmarginal, adjust="tukey")

```

```{r}
OPmarginal = emmeans(OP_Aov, ~Block)
pairs(OPmarginal, adjust="tukey")

```

```{r}
EFmarginal = emmeans(EF_Aov, ~Block)
pairs(EFmarginal, adjust="tukey")

```

```{r}
FRmarginal = emmeans(FR_Aov, ~Block)
pairs(FRmarginal, adjust="tukey")

```


```{r}
TLXTotalNullmodel <- lmer(data = TLXdata, Total + (1|ID))
TLXTotalmodel1 <- lmer(data = TLXdata, Total ~Block + (1|ID))

anova(TLXTotalNullmodel,TLXTotalmodel1)

summary(TLXTotalmodel)
```


```{r}
Totalresults <- report(TLXTotalmodel, CI = 95)

print(Totalresults)
```

```{r}

TLXMentalmodel <- lmer(data = TLXdata, `Mental Demand` ~Block+Condition + (1|ID))

TLXMentalmodel2 <- lmer(data = TLXdata, `Mental Demand` ~Block*Condition + (1|ID))

anova(TLXMentalmodel, TLXMentalmodel2)

summary(TLXMentalmodel)

Mentalresults <- report(TLXMentalmodel, CI = 95)

print(Mentalresults)
```
```{r}
TLXPhysmodel <- lmer(data = TLXdata, `Physical Demand` ~Block+Condition + (1|ID))


TLXPhysmodel2 <- lmer(data = TLXdata, `Physical Demand` ~Block*Condition + (1|ID))

TLXPhysmodel3 <- lmer(data = TLXdata, `Physical Demand` ~Condition + (1|ID))



summary(TLXPhysmodel2)

anova (TLXPhysmodel, TLXPhysmodel2)


summary(TLXPhysmodel)

Physresults <- report(TLXPhysmodel2, CI = 95)

print(Physresults)
```
```{r}
TLXTempmodel <- lmer(data = TLXdata, `Temporal Demand` ~Block+Condition + (1|ID))


TLXTempmodel2 <- lmer(data = TLXdata, `Temporal Demand` ~Block*Condition + (1|ID))


anova(TLXTempmodel, TLXTempmodel2)

summary(TLXTempmodel)

Tempresults <- report(TLXTempmodel, CI = 95)

print(Tempresults)
```

```{r}
TLXEffortmodel <- lmer(data = TLXdata, Effort ~Block+Condition + (1|ID))
TLXEffortmodel2 <- lmer(data = TLXdata, Effort ~Block*Condition + (1|ID))

anova(TLXEffortmodel, TLXEffortmodel2)

summary(TLXEffortmodel)
Effortresults <- report(TLXEffortmodel, CI = 95)

print(Effortresults)
```

```{r}
TLXFrusmodel <- lmer(data = TLXdata, Frustration ~Block*Condition + (1|ID))

summary(TLXFrusmodel)

Frusresults <- report(TLXFrusmodel, CI = 95)

print(Frusresults)
```

```{r}
TLXPerfmodel <- lmer(data = TLXdata, Performance ~Block*Condition + (1|ID))

summary(TLXPerfmodel)

Perfresults <- report(TLXPerfmodel, CI = 95)

print(Perfresults)
```